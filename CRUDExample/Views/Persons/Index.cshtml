@model List<PersonResponse>
@{
	ViewBag.Title = "Persons";
	var personSearchOption = (Dictionary<PersonSearchOptions, string>)ViewBag.SearchFields;

	PersonSearchOptions currentSearchBy = ViewBag.CurrentSearchBy;
	string currentSearch = ViewBag.CurrentSearch;
	PersonSearchOptions? currentSortBy = ViewBag.CurrentSortBy;
	SortOrderOptions currentSortOrder = ViewBag.CurrentSortOrder;
}

<h1>Persons</h1>

<a asp-controller="Persons" asp-action="Create">Create Person</a>

<form asp-controller="Persons" asp-action="Index" method="get">
	<div class="box flex">
		<div class="flex-1">
			<select class="form-input" name="searchBy">
				@foreach (var searchOption in personSearchOption)
				{
					if (ViewBag.CurrentSearchBy == searchOption.Key)
					{
						<option value="@searchOption.Key" selected>@searchOption.Value</option>
					}
					else
					{
						<option value="@searchOption.Key">@searchOption.Value</option>
					}
				}
			</select>
		</div>
		<div class="flex-1">
			<input type="search" id="Search" class="form-input" placeholder="Search" name="search" value="@ViewBag.CurrentSearch" />
		</div>
		<div class="flex-1">
			<button class="button button-blue-back" type="submit">Search</button>
			<a asp-controller="Persons" asp-action="Index" class="link-hover">Clear all</a>
		</div>
	</div>
</form>

<table class="table w-100 mt">
	<colgroup>
		<col style="width:15%">  <!-- Person Name -->
		<col style="width:20%">  <!-- Email -->
		<col style="width:12%">  <!-- Date Of Birth -->
		<col style="width:6%">   <!-- Age -->
		<col style="width:8%">   <!-- Gender -->
		<col style="width:10%">  <!-- Country -->
		<col style="width:18%">  <!-- Address -->
		<col style="width:11%">   <!-- Receive News Letter -->
		<col style="width:20%">   <!-- Receive News Letter -->
	</colgroup>
	<thead>
		<tr>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.PersonName)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.Email)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.DateOfBirth)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.Age)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.Gender)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.Country)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.Address)
			</th>
			<th>
				@await Html.PartialAsync("_GridColumnHeader", PersonSearchOptions.ReceiveNewsLetter)
			</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		@foreach (PersonResponse person in Model)
		{
			<tr>
				<td>@person.PersonName</td>
				<td>@person.Email</td>
				<td>@person.DateOfBirth?.ToString("dd MM yyyy")</td>
				<td>@person.Age</td>
				<td>@person.Gender</td>
				<td>@person.Country</td>
				<td>@person.Address</td>
				<td>@person.ReceiveNewsLetters</td>
				<td>
					<a asp-controller="Persons" asp-action="Edit" asp-route-personId="@person.PersonId">Edit</a>
					<a asp-controller="Persons" asp-action="Delete" asp-route-personId="@person.PersonId">Delete</a>
				</td>
			</tr>
		}
	</tbody>
</table>